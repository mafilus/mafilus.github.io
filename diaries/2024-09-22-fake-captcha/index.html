<!DOCTYPE html>
<html lang="fr"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v9.2.1 <https://hydejack.com/>
-->







<head>
  




  <meta name="robots" content="noindex">



  
    
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Fake Captcha | Mafilus Diaries</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Fake Captcha" />
<meta name="author" content="Mafilus Network" />
<meta property="og:locale" content="fr" />
<meta name="description" content="Verify You Are A Captcha" />
<meta property="og:description" content="Verify You Are A Captcha" />
<link rel="canonical" href="https://mafilus.github.io/diaries/2024-09-22-fake-captcha/" />
<meta property="og:url" content="https://mafilus.github.io/diaries/2024-09-22-fake-captcha/" />
<meta property="og:site_name" content="Mafilus Diaries" />
<meta property="og:image" content="https://mafilus.github.io/assets/img/blog/captcha.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-09-22T00:00:00+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://mafilus.github.io/assets/img/blog/captcha.png" />
<meta property="twitter:title" content="Fake Captcha" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mafilus Network"},"dateModified":"2024-09-22T06:09:04+02:00","datePublished":"2024-09-22T00:00:00+02:00","description":"Verify You Are A Captcha","headline":"Fake Captcha","image":"https://mafilus.github.io/assets/img/blog/captcha.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://mafilus.github.io/diaries/2024-09-22-fake-captcha/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mafilus.github.io/assets/img/logo.png"},"name":"Mafilus Network"},"url":"https://mafilus.github.io/diaries/2024-09-22-fake-captcha/"}</script>
<!-- End Jekyll SEO tag -->


  

  
    <meta name="keywords" content="cybersec">
  



  <meta name="color-scheme" content="dark light">



  <meta name="theme-color" content="rgb(25,55,71)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Mafilus Diaries">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="Mafilus Diaries">

<meta name="generator" content="Hydejack v9.2.1" />


<link rel="alternate" href="https://mafilus.github.io/diaries/2024-09-22-fake-captcha/" hreflang="fr">

<link type="application/atom+xml" rel="alternate" href="https://mafilus.github.io/feed.xml" title="Mafilus Diaries" />


<link rel="shortcut icon"    href="/assets/img/icons/favicon.ico">
<link rel="apple-touch-icon" href="/assets/img/icons/logo.png">

<link rel="manifest" href="/assets/site.webmanifest">





<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">


  
  <link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css" id="_katexPreload">
  <noscript><link rel="stylesheet" href="/assets/bower_components/katex/dist/katex.min.css"></noscript>





<script>((r,a)=>{function d(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=a.createElement("script"),e=(n.src=e,t&&d(n,"load",t,{once:!0}),a.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=a.createElement("script");function o(){r._loaded=!0,t&&d(n,"load",t,{once:!0});var e=a.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():d(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){d(a.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}})(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = false;
  w._noToc = false;
  w._noSearch = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2024-09-27T09:24:48+02:00',
  };
  w._clapButton = true;
}(window);</script>



<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.2.1.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">




  <style id="_pageStyle">

html{--accent-color: rgb(79,177,186);--accent-color-faded: rgba(79, 177, 186, 0.5);--accent-color-highlight: rgba(79, 177, 186, 0.1);--accent-color-darkened: rgb(63.8602040816, 154.5602040816, 162.8897959184);--theme-color: rgb(25,55,71);--dark-mode-body-bg: hsl(200.8695652174, 5.9895833333%, 17.5%);--dark-mode-border-color: hsl(200.8695652174, 5.9895833333%, 22.5%)}
</style>


<!--<![endif]-->





</head>

<body class="no-break-layout">
  
<script>
  window._sunrise = 6;
  window._sunset =  18;
  ((e,s)=>{var d="light-mode",a="dark-mode",o=(new Date).getHours();"matchMedia"in e&&e.matchMedia("(prefers-color-scheme)")||(e=(o=o<=e._sunrise||o>=e._sunset?a:d)==a?d:a,s.body.classList.add(o),s.body.classList.remove(e))})(window,document);

</script>



<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Go Go:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-post"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/diaries/">diaries</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>2024-09-22-fake-captcha</span>
        
      </li>
    
  
</ul></nav>
  










<article id="post-diaries-fake-captcha" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        Fake Captcha
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2024-09-22T00:00:00+02:00">22 Sep 2024</time> in <span>Diaries</span> 
      </span>
      
        
          
          
          
        
      
    </div>

    
    
      
        <div class="img-wrapper lead aspect-ratio sixteen-nine flip-project-img">
          


<img
  
    src="/assets/img/blog/captcha.png"
  
  alt="Fake Captcha"
  
  
  width="864"
  height="486"
  loading="lazy"
/>

        </div>
      
      
    

    



  
    <p class="note-sm" >
      Verify You Are A Captcha

    </p>
  


  </header>

  
    <p>Imaginer, vous recevez un email d’une <strong>alerte de github</strong>. Imaginer qu’une <strong>entreprise de sécurité</strong> vous informe que vous avez une <strong>grave vulnérabilité</strong> au sein de votre projet. Imaginer que rapidement, vous cliquez sur le <strong>lien du site web</strong> qui vous indique la vulnérabilité. Imaginer qu’un <strong>captcha</strong> doit vérifier si vous êtes humain. Imaginer que le captcha vous demande d’appuyer sur des <strong>touches de votre clavier</strong>. Cette histoire est arrivée à <a href="https://isc.sans.edu/diary/Fake+GitHub+Site+Targeting+Developers/31282">Johannes Ullrich</a>.</p>

<h2 id="fonctionnement-de-lattaque">Fonctionnement de l’attaque</h2>

<p><img src="/assets/img/blog/captcha.png" alt="800x400" title="capitaine chat" /></p>

<p>L’attaque se repose sur <strong>l’ingénierie sociale</strong> par <strong>phishing</strong>. L’objectif est que la cible effectue les combinaisons de touches du clavier. Tout le début de l’attaque incite la cible à aller sur le lien du site web. La deuxième phase affiche un faux captcha qui oblige la cible à suivre ses indications pour accéder au site web. Ses indications sont une succession de combinaison de touches. Cette combinaison de touches est l’ouverture d’une boite de dialogue qui permet d’exécuter des lignes de commande : le raccourci clavier “Windows + R”. L’indication suivante est la combinaison “Ctrl + V” qui va coller le contenu du presse-papier. La dernière indication est d’appuyer sur Entrée pour valider la ligne de commande. L’intelligence du site web est de préremplir le presse-papier. Ainsi, l’utilisateur ne sait pas qu’il effectue un copier-coller dont la source provient du site web de l’attaquant.</p>

<p><img src="https://isc.sans.edu/diaryimages/images/Screenshot%202024-09-19%20at%204_03_02%E2%80%AFPM.png" alt="400x200" title="Crédit : Johannes Ullrich" />
Crédit : Johannes Ullrich</p>

<p>Bien entendu, le presse-papier contient une charge malveillante qui est lancé en ligne de commande. La cible se fait <strong>infecter</strong>.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Dans ce cadre, c’est un professionnel de la cybersécurité qui a été visé, mais ce sont les particuliers/utilisateurs finaux qui sont le plus susceptible de tomber dans le piège. Le fait que les captchas soumettent l’utilisateur à effectuer des actions rend l’attaque par Fake Captcha bien plus efficace. Parmi vos utilisateurs et votre entourage, qui serait en mesure de connaître les implications du raccourci de la combinaison de “Windows + R” ? La contre-mesure possible : désactiver le raccourci clavier. Une solution qui restera efficace… <em>jusqu’à la prochaine attaque d’ingénierie sociale</em>.</p>

<p>Je vous laisse avec un lien qui décrit une procédure de désactivation de la combinaison de touches “Windows + R”. <a href="https://www.top-password.com/blog/disable-run-command-in-windows-10/">Disable run command</a></p>

<p>Source : <a href="https://github.com/JohnHammond/recaptcha-phish">Projet de recaptcha phising de John Hammond</a></p>

  
</article>



  <hr class="dingbat related mb6" />






  
     


  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img
  
    src="https://avatars.githubusercontent.com/u/80053810?v=4"
    srcset="https://avatars.githubusercontent.com/u/80053810?v=4 1x,https://avatars.githubusercontent.com/u/80053810?v=4 2x"
    
  
  alt="Mafilus Network"
  class="avatar"
  
  width="120"
  height="120"
  loading="lazy"
/>

  

  
  
  <h2  class="page-title hr-bottom">
    About
  </h2>

  <p>Je suis chercheur en cybersécurité. Au chômage, j’expérimente les différents domaines de la cybersécurité. Je peux passer mes journées à développer un outil, un service dans une multitude de piles logicielles, à implémenter des laboratoires de recherche sur diverses technologies et analyser des menaces. J’ai une sensibilité pour la gouvernance : gestion du risque. Je suis spécialisé dans les techniques de contournement de sécurité. Donc, je suis un fin connaisseur des technologies liées aux mesures de sécurité.<br /><br />Niveau pro : j’ai fait de l’audit de pentest en mode red team, mais en contrat pentest, de l’investigation numérique. J’ai été formateur, j’ai envie de mettre “formatueur”, parce que j’ai détruit des cerveaux. J’ai fait des études en sysadmin et en réseau, j’ai fait des études en dev système. Pour l’anecdote, je n’avais pas mis un pied dans une école d’informatique que je savais écrire des daemons réseaux en C. Les profs que j’ai eu n’avaient jamais fait ça de leur vie. “<em>insérer rire gras</em>”. Bonne base de connaissance. <br /><br />Niveau perso : j’aime les chats.</p>


  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://x.com/Mafilus" title="X / Twitter" class="no-mark-external">
      <span class="icon-twitter"></span>
      <span class="sr-only">X / Twitter</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/mafilus" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>


  

  
  

  
    


  <aside class="related mb4" role="complementary">  <h2 class="hr-bottom">Mes trucs</h2>  <ul class="related-posts">                  <li class="h4">  <a href="/diaries/2024-09-27-make-cups/" class="flip-title"><span>Make CUPS</span></a>  <time class="faded fine" datetime="2024-09-27T00:00:00+02:00">27 Sep 2024</time></li>                        <li class="h4">  <a href="/diaries/2024-09-21-edr-vs-script/" class="flip-title"><span>Bring Your Own Script Interpreter</span></a>  <time class="faded fine" datetime="2024-09-21T00:00:00+02:00">21 Sep 2024</time></li>                        <li class="h4">  <a href="/diaries/2024-09-19-taptounon/" class="flip-title"><span>Pseudo Terminal Master / Pseudo Terminal Slave</span></a>  <time class="faded fine" datetime="2024-09-19T00:00:00+02:00">19 Sep 2024</time></li>            </ul></aside>

  

  
  


  
<footer class="content" role="contentinfo">
  <hr/>
  
    <p><small class="copyright">© -39999 to 2024. All rights reserved.
</small></p>
  
  
    <nav class="legal"><small>
    
      
      <a class="heading flip-title" href="/LICENCE/">LICENCE</a>
      
    
    </small></nav>
  
    <p><small>Powered by <a class="external" href="https://hydejack.com/">Hydejack</a> v<span id="_version">9.2.1</span></small></p>
  <hr class="sr-only"/>
</footer>


</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg sidebar-overlay" style="background-color:rgb(25,55,71);background-image:url(/assets/img/bg.jpeg)"></div>

    <div class="sidebar-sticky">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="/assets/img/logo.png" class="avatar" alt="Mafilus Diaries" width="120" height="120" loading="lazy" />
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h1">Mafilus Diaries</h2></a>
    
    
      <p class="">
        Aller les potos

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/charlie/"
          class="sidebar-nav-item "
          
        >
          Où est charlie ?
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/diaries/"
          class="sidebar-nav-item "
          
        >
          Mes vampires diaries
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/about/"
          class="sidebar-nav-item "
          
        >
          Moi, moi... Moi!
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://x.com/Mafilus" title="X / Twitter" class="no-mark-external">
      <span class="icon-twitter"></span>
      <span class="sr-only">X / Twitter</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/mafilus" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>(()=>{var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())})();
</script>
  <script src="/assets/js/hydejack-9.2.1.js" type="module"></script>
  <script src="/assets/js/LEGACY-hydejack-9.2.1.js" nomodule defer></script>
  

  

<!--<![endif]-->
  <!--
Code for integrating CloudFlare's email protection with Hydejack's single page app loading.
-->
<script>
  document.getElementById('_pushState').addEventListener('hy-push-state-after', function (e) {
    function e(e){
      (console.error?console.error:console.log).call(console,e)
    }

    function t(e){
      return l.innerHTML='<a href="'+e.replace(/"/g,"&quot;")+'"></a>',l.childNodes[0].getAttribute("href")
    }

    function r(e,t){
      var r=e.substr(t,2);return parseInt(r,16)
    }

    function n(e,n){
      for(var o="",c=r(e,n),a=n+2;a<e.length;a+=2){
        var l=r(e,a)^c;
        o+=String.fromCharCode(l)
      }
      return t(o)
    }

    var o="/cdn-cgi/l/email-protection#",
        c=".__cf_email__",
        a="data-cfemail",
        l=document.createElement("div");

    !function(){
      for(var t=document.getElementsByTagName("a"),r=0;r<t.length;r++)
        try{
          var c=t[r],a=c.href.indexOf(o);
          a>-1&&(c.href="mailto:"+n(c.href,a+o.length))
        }catch(t){
          e(t)
        }
    }(),
    function(){
      for(var t=document.querySelectorAll(c),r=0;r<t.length;r++)
        try{
          var o=t[r],l=n(o.getAttribute(a),0),i=document.createTextNode(l);
          o.parentNode.replaceChild(i,o)
        }catch(t){
          e(t)
        }
    }()
  });
</script>





<div hidden>
  
  <h2 class="sr-only">Templates (for web app):</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">En route Marcel !</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Error</h1>
    
    
    <p class="lead">
      "J'ai merdé, j'ai fait un erreur. Est-ce que je dirais que c'était un échec ? Non, mais je dirais clairement que ça n'a pas fonctionné."

    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover" >
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
</div>


</body>
</html>
